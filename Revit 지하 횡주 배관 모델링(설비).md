# Revit 지하 횡주 배관(오배수, 위생/공조, 소화) 최적화 경로 모델링 시스템

## 기간
2025년 7월 ~ 12월

## 목적
기존 Revit(3D) 모델에서 AutoCAD 파일과 최적화된 dll파일의 좌표 정보, 사용자의 UI 정보를 활용하여
최적화 경로 확인 및 경로 생성 이후 조건에 맞는 오배수, 위생/공조, 소화 배관 생성

## 팀원
- 1명 (개발자)

## 사용 도구 및 기술
- **C#**
- **TortoiseSVN**
- **DevExpress**
- **Revit API**
- **AutoCAD**

## 주요 기능 및 구현 내용

- **dll정보 Excel 정보, 사용자 UI 정보 기반 자동 모델링**
  - dll 정보와 Excel 정보를 통해로부터 Level, 패밀리 타입, Workset, systemType등  정보를 읽어들여 해당 도면의 Default 값을 설정

- **경로 지점 생성**
  - 기계실부터 각 코어 지점까지 임의의 선 생성
  - 선과 가장 가까운 Detail 혹은 Model Line을 지정하여 최적화 동 인입점 확인
  - 사용자의 선택으로 동 인입점 확인
  
- **경로 생성**
  - dll정보에 위치한 각 배관에 맞는 코어 지점 위치 확인
  - 사용자 UI 정보를 통해 동인입점 위치 확인
  - 동 인입점을 시작점으로, 코어 지점을 도착 지점으로 지정후 가장 긴 경로를 main배관으로 이후 main배관에 branch의 형식을 가진 경로를 생성

- **경로 모델링**
  - 생성한 경로를 기준으로 설정된 배관 모델링

- **특정 구역 진로 회피 로직**
  - 예시: 기둥, 외벽
    경로 생성시 특정 이름을 가진 Line을 회피하여 진행
  - 오배수, 위생/공조, 소화 각각 경로 생성 시 교차 가능

- **자동화 프로세스**
  1. Revit 패밀리 객체 자동 생성 및 지정 위치/Level로 배치
  2. 오배수 : 필로티 구간의 높이를 통해 모델링 위치 자동 조절
  3. 위생/공조 : 동인입점 물 흐름기, 충격방지기 자동 설치
  4. 소화 : 1층부터 최고층 까지 높이의 차이가 70m 이상, 미만인 조건을 통해 SC 소화 라인 자동 적용
  5. 장애물 회피 및 연결 최적화 처리

---

> 본 프로젝트는 Revit API의 에이스타 알고리즘 로직 등  
> 건축 법규와 실무 프로세스를 최적화하여, BIM 환경의 도면 작업 자동화 수준을 크게 높였습니다.
